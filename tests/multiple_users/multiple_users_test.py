from pages.base_element import BaseElement
from pages.base_page import BasePage
from pages.css_selectors import CSS_SELECTORS
from pages.mongo_db import Connect, DATABASE_CONNECTION_STRINGS, DATABASE_KEYS
import time
import datetime

CSV_PERSONAL_KEYS = {
    'User_1': '1000000000001',
    'User_2': '1000000000002',
    'User_3': '1000000000003',
    'User_4': '1000000000004',
    'User_5': '1000000000005',
    'User_6': '1000000000006',
    'User_7': '1000000000007',
    'User_8': '1000000000008',
    'User_9': '1000000000009',
    'User_10': '1000000000010',
    'User_11': '1000000000011',
    'User_12': '1000000000012',
    'User_13': '1000000000013',
    'User_14': '1000000000014',
    'User_15': '1000000000015',
    'User_16': '1000000000016',
    'User_17': '1000000000017',
    'User_18': '1000000000018',
    'User_19': '1000000000019',
    'User_20': '1000000000020',
    'User_21': '1000000000021',
    'User_22': '1000000000022',
    'User_23': '1000000000023',
    'User_24': '1000000000024',
    'User_25': '1000000000025',
    'User_26': '1000000000026',
    'User_27': '1000000000027',
    'User_28': '1000000000028',
    'User_29': '1000000000029',
    'User_30': '1000000000030',
    'User_31': '1000000000031',
    'User_32': '1000000000032',
    'User_33': '1000000000033',
    'User_34': '1000000000034',
    'User_35': '1000000000035',
    'User_36': '1000000000036',
    'User_37': '1000000000037',
    'User_38': '1000000000038',
    'User_39': '1000000000039',
    'User_40': '1000000000040',
    'User_41': '1000000000041',
    'User_42': '1000000000042',
    'User_43': '1000000000043',
    'User_44': '1000000000044',
    'User_45': '1000000000045',
    'User_46': '1000000000046',
    'User_47': '1000000000047',
    'User_48': '1000000000048',
    'User_49': '1000000000049',
    'User_50': '1000000000050',
    'User_51': '1000000000051',
    'User_52': '1000000000052',
    'User_53': '1000000000053',
    'User_54': '1000000000054',
    'User_55': '1000000000055',
    'User_56': '1000000000056',
    'User_57': '1000000000057',
    'User_58': '1000000000058',
    'User_59': '1000000000059',
    'User_60': '1000000000060',
    'User_61': '1000000000061',
    'User_62': '1000000000062',
    'User_63': '1000000000063',
    'User_64': '1000000000064',
    'User_65': '1000000000065',
    'User_66': '1000000000066',
    'User_67': '1000000000067',
    'User_68': '1000000000068',
    'User_69': '1000000000069',
    'User_70': '1000000000070',
    'User_71': '1000000000071',
    'User_72': '1000000000072',
    'User_73': '1000000000073',
    'User_74': '1000000000074',
    'User_75': '1000000000075',
    'User_76': '1000000000076',
    'User_77': '1000000000077',
    'User_78': '1000000000078',
    'User_79': '1000000000079',
    'User_80': '1000000000080',
    'User_81': '1000000000081',
    'User_82': '1000000000082',
    'User_83': '1000000000083',
    'User_84': '1000000000084',
    'User_85': '1000000000085',
    'User_86': '1000000000086',
    'User_87': '1000000000087',
    'User_88': '1000000000088',
    'User_89': '1000000000089',
    'User_90': '1000000000090',
    'User_91': '1000000000091',
    'User_92': '1000000000092',
    'User_93': '1000000000093',
    'User_94': '1000000000094',
    'User_95': '1000000000095',
    'User_96': '1000000000096',
    'User_97': '1000000000097',
    'User_98': '1000000000098',
    'User_99': '1000000000099',
    'User_100': '1000000000100',
    'User_101': '1000000000101',
    'User_102': '1000000000102',
    'User_103': '1000000000103',
    'User_104': '1000000000104',
    'User_105': '1000000000105',
    'User_106': '1000000000106',
    'User_107': '1000000000107',
    'User_108': '1000000000108',
    'User_109': '1000000000109',
    'User_110': '1000000000110',
    'User_111': '1000000000111',
    'User_112': '1000000000112',
    'User_113': '1000000000113',
    'User_114': '1000000000114',
    'User_115': '1000000000115',
    'User_116': '1000000000116',
    'User_117': '1000000000117',
    'User_118': '1000000000118',
    'User_119': '1000000000119',
    'User_120': '1000000000120',
    'User_121': '1000000000121',
    'User_122': '1000000000122',
    'User_123': '1000000000123',
    'User_124': '1000000000124',
    'User_125': '1000000000125',
    'User_126': '1000000000126',
    'User_127': '1000000000127',
    'User_128': '1000000000128',
    'User_129': '1000000000129',
    'User_130': '1000000000130',
    'User_131': '1000000000131',
    'User_132': '1000000000132',
    'User_133': '1000000000133',
    'User_134': '1000000000134',
    'User_135': '1000000000135',
    'User_136': '1000000000136',
    'User_137': '1000000000137',
    'User_138': '1000000000138',
    'User_139': '1000000000139',
    'User_140': '1000000000140',
    'User_141': '1000000000141',
    'User_142': '1000000000142',
    'User_143': '1000000000143',
    'User_144': '1000000000144',
    'User_145': '1000000000145',
    'User_146': '1000000000146',
    'User_147': '1000000000147',
    'User_148': '1000000000148',
    'User_149': '1000000000149',
    'User_150': '1000000000150',
    'User_151': '1000000000151',
    'User_152': '1000000000152',
    'User_153': '1000000000153',
    'User_154': '1000000000154',
    'User_155': '1000000000155',
    'User_156': '1000000000156',
    'User_157': '1000000000157',
    'User_158': '1000000000158',
    'User_159': '1000000000159',
    'User_160': '1000000000160',
    'User_161': '1000000000161',
    'User_162': '1000000000162',
    'User_163': '1000000000163',
    'User_164': '1000000000164',
    'User_165': '1000000000165',
    'User_166': '1000000000166',
    'User_167': '1000000000167',
    'User_168': '1000000000168',
    'User_169': '1000000000169',
    'User_170': '1000000000170',
    'User_171': '1000000000171',
    'User_172': '1000000000172',
    'User_173': '1000000000173',
    'User_174': '1000000000174',
    'User_175': '1000000000175',
    'User_176': '1000000000176',
    'User_177': '1000000000177',
    'User_178': '1000000000178',
    'User_179': '1000000000179',
    'User_180': '1000000000180',
    'User_181': '1000000000181',
    'User_182': '1000000000182',
    'User_183': '1000000000183',
    'User_184': '1000000000184',
    'User_185': '1000000000185',
    'User_186': '1000000000186',
    'User_187': '1000000000187',
    'User_188': '1000000000188',
    'User_189': '1000000000189',
    'User_190': '1000000000190',
    'User_191': '1000000000191',
    'User_192': '1000000000192',
    'User_193': '1000000000193',
    'User_194': '1000000000194',
    'User_195': '1000000000195',
    'User_196': '1000000000196',
    'User_197': '1000000000197',
    'User_198': '1000000000198',
    'User_199': '1000000000199',
    'User_200': '1000000000200',
    'User_201': '1000000000201',
    'User_202': '1000000000202',
    'User_203': '1000000000203',
    'User_204': '1000000000204',
    'User_205': '1000000000205',
    'User_206': '1000000000206',
    'User_207': '1000000000207',
    'User_208': '1000000000208',
    'User_209': '1000000000209',
    'User_210': '1000000000210',
    'User_211': '1000000000211',
    'User_212': '1000000000212',
    'User_213': '1000000000213',
    'User_214': '1000000000214',
    'User_215': '1000000000215',
    'User_216': '1000000000216',
    'User_217': '1000000000217',
    'User_218': '1000000000218',
    'User_219': '1000000000219',
    'User_220': '1000000000220',
    'User_221': '1000000000221',
    'User_222': '1000000000222',
    'User_223': '1000000000223',
    'User_224': '1000000000224',
    'User_225': '1000000000225',
    'User_226': '1000000000226',
    'User_227': '1000000000227',
    'User_228': '1000000000228'
}

CSV_USERS_PHONE_NUMBERS = {
    'User_1': '6468234597',
    'User_2': '9732147272',
    'User_3': '9176925716',
    'User_4': '7814928412',
    'User_5': '9176967595',
    'User_6': '2038598487',
    'User_7': '6508626909',
    'User_8': '2104163232',
    'User_9': '2104168077',
    'User_10': '6317074907',
    'User_11': '3477120289',
    'User_12': '9733494073',
    'User_13': '9736469878',
    'User_14': '9089221565',
    'User_15': '9545404420',
    'User_16': '9175207810',
    'User_17': '6468234596',
    'User_18': '6463592518',
    'User_19': '9178420364',
    'User_20': '6468310868',
    'User_21': '9254133466',
    'User_22': '9254133465',
    'User_23': '9256780686',
    'User_24': '6144192698',
    'User_25': '9785489757',
    'User_26': '9783028786',
    'User_27': '6096471794',
    'User_28': '6467611569',
    'User_29': '6318341325',
    'User_30': '9178814090',
    'User_31': '7203479056',
    'User_32': '6153008173',
    'User_33': '6262424828',
    'User_34': '8148809931',
    'User_35': '3105009488',
    'User_36': '8019039914',
    'User_37': '3238071834',
    'User_38': '8184820197',
    'User_39': '2134481932',
    'User_40': '4156094582',
    'User_41': '2072087307',
    'User_42': '6177509971',
    'User_43': '5084046000',
    'User_44': '6307475116',
    'User_45': '6304429175',
    'User_46': '7329957677',
    'User_47': '6317397296',
    'User_48': '4809098191',
    'User_49': '2035209421',
    'User_50': '9175200261',
    'User_51': '9176536187',
    'User_52': '3475893519',
    'User_53': '9178610528',
    'User_54': '9173998294',
    'User_55': '3479518012',
    'User_56': '6144969167',
    'User_57': '8603980938',
    'User_58': '3093104730',
    'User_59': '3096484730',
    'User_60': '4152152035',
    'User_61': '8568994570',
    'User_62': '6104015346',
    'User_63': '9175737998',
    'User_64': '2488408424',
    'User_65': '6468948236',
    'User_66': '4155777586',
    'User_67': '9175614475',
    'User_68': '3475895646',
    'User_69': '9173097739',
    'User_70': '9174158727',
    'User_71': '6462291312',
    'User_72': '9176967228',
    'User_73': '7543668021',
    'User_74': '9706804107',
    'User_75': '7744878822',
    'User_76': '9174123634',
    'User_77': '6468433242',
    'User_78': '3472444601',
    'User_79': '4048409530',
    'User_80': '6313750865',
    'User_81': '9175974388',
    'User_82': '6462800912',
    'User_83': '7189090305',
    'User_84': '6468964859',
    'User_85': '9175762695',
    'User_86': '3479817796',
    'User_87': '9142624629',
    'User_88': '5103258486',
    'User_89': '3474182441',
    'User_90': '9543360198',
    'User_91': '3108806166',
    'User_92': '3475746714',
    'User_93': '9175326124',
    'User_94': '7187300240',
    'User_95': '3479069351',
    'User_96': '3474290332',
    'User_97': '6462296981',
    'User_98': '9176699331',
    'User_99': '9174063764',
    'User_100': '9178151641',
    'User_101': '9292728364',
    'User_102': '8286068017',
    'User_103': '6465286503',
    'User_104': '3133777107',
    'User_105': '3133105799',
    'User_106': '4123704549',
    'User_107': '3048900389',
    'User_108': '3048900398',
    'User_109': '9175386834',
    'User_110': '9135223173',
    'User_111': '2817983178',
    'User_112': '6468743006',
    'User_113': '6467054882',
    'User_114': '9173021710',
    'User_115': '6468234597',
    'User_116': '9732147272',
    'User_117': '9176925716',
    'User_118': '7814928412',
    'User_119': '9176967595',
    'User_120': '2038598487',
    'User_121': '6508626909',
    'User_122': '2104163232',
    'User_123': '2104168077',
    'User_124': '6317074907',
    'User_125': '3477120289',
    'User_126': '9733494073',
    'User_127': '9736469878',
    'User_128': '9089221565',
    'User_129': '9545404420',
    'User_130': '9175207810',
    'User_131': '6468234596',
    'User_132': '6463592518',
    'User_133': '9178420364',
    'User_134': '6468310868',
    'User_135': '9254133466',
    'User_136': '9254133465',
    'User_137': '9256780686',
    'User_138': '6144192698',
    'User_139': '9785489757',
    'User_140': '9783028786',
    'User_141': '6096471794',
    'User_142': '6467611569',
    'User_143': '6318341325',
    'User_144': '9178814090',
    'User_145': '7203479056',
    'User_146': '6153008173',
    'User_147': '6262424828',
    'User_148': '8148809931',
    'User_149': '3105009488',
    'User_150': '8019039914',
    'User_151': '3238071834',
    'User_152': '8184820197',
    'User_153': '2134481932',
    'User_154': '4156094582',
    'User_155': '2072087307',
    'User_156': '6177509971',
    'User_157': '5084046000',
    'User_158': '6307475116',
    'User_159': '6304429175',
    'User_160': '7329957677',
    'User_161': '6317397296',
    'User_162': '4809098191',
    'User_163': '2035209421',
    'User_164': '9175200261',
    'User_165': '9176536187',
    'User_166': '3475893519',
    'User_167': '9178610528',
    'User_168': '9173998294',
    'User_169': '3479518012',
    'User_170': '6144969167',
    'User_171': '8603980938',
    'User_172': '3093104730',
    'User_173': '3096484730',
    'User_174': '4152152035',
    'User_175': '8568994570',
    'User_176': '6104015346',
    'User_177': '9175737998',
    'User_178': '2488408424',
    'User_179': '6468948236',
    'User_180': '4155777586',
    'User_181': '9175614475',
    'User_182': '3475895646',
    'User_183': '9173097739',
    'User_184': '9174158727',
    'User_185': '6462291312',
    'User_186': '9176967228',
    'User_187': '7543668021',
    'User_188': '9706804107',
    'User_189': '7744878822',
    'User_190': '9174123634',
    'User_191': '6468433242',
    'User_192': '3472444601',
    'User_193': '4048409530',
    'User_194': '6313750865',
    'User_195': '9175974388',
    'User_196': '6462800912',
    'User_197': '7189090305',
    'User_198': '6468964859',
    'User_199': '9175762695',
    'User_200': '3479817796',
    'User_201': '9142624629',
    'User_202': '5103258486',
    'User_203': '3474182441',
    'User_204': '9543360198',
    'User_205': '3108806166',
    'User_206': '3475746714',
    'User_207': '9175326124',
    'User-208': '7187300240',
    'User_209': '3479069351',
    'User_210': '3474290332',
    'User_211': '6462296981',
    'User_212': '9176699331',
    'User_213': '9174063764',
    'User_214': '9178151641',
    'User_215': '9292728364',
    'User_216': '8286068017',
    'User_217': '6465286503',
    'User_218': '3133777107',
    'User_219': '3133105799',
    'User_220': '4123704549',
    'User_221': '3048900389',
    'User_222': '3048900398',
    'User_223': '9175386834',
    'User_224': '9135223173',
    'User_225': '2817983178',
    'User_226': '6468743006',
    'User_227': '6467054882',
    'User_228': '9173021710'
}

list_of_users = ['User_1', 'User_2', 'User_3', 'User_4', 'User_5', 'User_6', 'User_7', 'User_8', 'User_9', 'User_10',
                 'User_11', 'User_12', 'User_13', 'User_14', 'User_15', 'User_16', 'User_17', 'User_18', 'User_19',
                 'User_20',
                 'User_21', 'User_22', 'User_23', 'User_24', 'User_25', 'User_26', 'User_27', 'User_28', 'User_29',
                 'User_30',
                 'User_31', 'User_32', 'User_33', 'User_34', 'User_35', 'User_36', 'User_37', 'User_38', 'User_39',
                 'User_40',
                 'User_41', 'User_42', 'User_43', 'User_44', 'User_45', 'User_46', 'User_47', 'User_48', 'User_49',
                 'User_50',
                 'User_51', 'User_52', 'User_53', 'User_54', 'User_55', 'User_56', 'User_57', 'User_58', 'User_59',
                 'User_60',
                 'User_61', 'User_62', 'User_63', 'User_64', 'User_65', 'User_66', 'User_67', 'User_68', 'User_69',
                 'User_70',
                 'User_71', 'User_72', 'User_73', 'User_74', 'User_75', 'User_76', 'User_77', 'User_78', 'User_79',
                 'User_80',
                 'User_81', 'User_82', 'User_83', 'User_84', 'User_85', 'User_86', 'User_87', 'User_88', 'User_89',
                 'User_90',
                 'User_91', 'User_92', 'User_93', 'User_94', 'User_95', 'User_96', 'User_97', 'User_98', 'User_99',
                 'User_100',
                 'User_101', 'User_102', 'User_103', 'User_104', 'User_105', 'User_106', 'User_107', 'User_108',
                 'User_109', 'User_110',
                 'User_111', 'User_112', 'User_113', 'User_114', 'User_115', 'User_116', 'User_117', 'User_118',
                 'User_119', 'User_120',
                 'User_121', 'User_122', 'User_123', 'User_124', 'User_125', 'User_126', 'User_127', 'User_128',
                 'User_129', 'User_130',
                 'User_131', 'User_132', 'User_133', 'User_134', 'User_135', 'User_136', 'User_137', 'User_138',
                 'User_139', 'User_140',
                 'User_141', 'User_142', 'User_143', 'User_144', 'User_145', 'User_146', 'User_147', 'User_148',
                 'User_149', 'User_150',
                 'User_151', 'User_152', 'User_153', 'User_154', 'User_155', 'User_156', 'User_157', 'User_158',
                 'User_159', 'User_160',
                 'User_161', 'User_162', 'User_163', 'User_164', 'User_165', 'User_166', 'User_167', 'User_168',
                 'User_169', 'User_170',
                 'User_171', 'User_172', 'User_173', 'User_174', 'User_175', 'User_176', 'User_177', 'User_178',
                 'User_179', 'User_180',
                 'User_181', 'User_182', 'User_183', 'User_184', 'User_185', 'User_186', 'User_187', 'User_188',
                 'User_189', 'User_190',
                 'User_191', 'User_192', 'User_193', 'User_194', 'User_195', 'User_196', 'User_197', 'User_198',
                 'User_199', 'User_200',
                 'User_201', 'User_202', 'User_203', 'User_204', 'User_205', 'User_206', 'User_207', 'User_208',
                 'User_209', 'User_210',
                 'User_211', 'User_212', 'User_213', 'User_214', 'User_215', 'User_216', 'User_217', 'User_218',
                 'User_219', 'User_220',
                 'User_221', 'User_222', 'User_223', 'User_224', 'User_225', 'User_226', 'User_227', 'User_228']

date_string = '04.11.1949 00:00'
date = datetime.datetime.strptime(date_string, "%m.%d.%Y %H:%M")


def test_lifemap_script(browser):
    connect = Connect()
    base_element = BaseElement(browser)
    base_page = BasePage(browser)

    for x in list_of_users:
        users_object = connect.return_object(connection_string=DATABASE_CONNECTION_STRINGS['phi_db_staging'],
                                             db_name='stars-gl-core-staging',
                                             collection_name='users',
                                             key=DATABASE_KEYS['memberPersonalGeneratedKey'],
                                             unique_value=CSV_PERSONAL_KEYS[x])
        token = users_object[DATABASE_KEYS['token']]

        base_page.load_url(subdomain='stars-lifemap-ui-staging.',
                           top_level_domain='herokuapp.com', second_level_domain='', subdirectory='/welcome?',
                           path=token, wait_element='div[id="app"]')
        time.sleep(1)
        base_page.scroll_to_bottom()
        time.sleep(1)

        base_element.send_user_input(input_data=CSV_USERS_PHONE_NUMBERS[x],
                                     input_field=CSS_SELECTORS["phone_input"],
                                     wait_element=CSS_SELECTORS["checkbox"])
        base_element.button_click(button_selector=CSS_SELECTORS["checkbox"],
                                  wait_element=CSS_SELECTORS['create_my_profile_button'])
        base_element.button_click(button_selector=CSS_SELECTORS['create_my_profile_button'],
                                  wait_element=CSS_SELECTORS['footer_next'])
        base_element.button_click(button_selector=CSS_SELECTORS['footer_next'],
                                  wait_element=CSS_SELECTORS['header_save'])
        base_element.button_click(button_selector=CSS_SELECTORS['header_save'],
                                  wait_element=CSS_SELECTORS['month_input'])

        time.sleep(1)
        base_page.scroll_to_bottom()

        base_element.send_user_input(input_data=date.month,
                                     input_field=CSS_SELECTORS["month_input"],
                                     wait_element=CSS_SELECTORS['footer_next'])
        base_element.send_user_input(input_data=date.day,
                                     input_field=CSS_SELECTORS["day_input"],
                                     wait_element=CSS_SELECTORS['footer_next'])
        base_element.send_user_input(input_data=date.year,
                                     input_field=CSS_SELECTORS["year_input"],
                                     wait_element=CSS_SELECTORS['footer_next'])
        base_element.button_click(button_selector=CSS_SELECTORS['footer_next'],
                                  wait_element=CSS_SELECTORS['footer_next'])

        browser.execute_script('window.localStorage.clear();')
        browser.delete_all_cookies()

        time.sleep(3)
